# FFT optimization practice for UNN Winter School 2024

Репозиторий для практической работы по оптимизации алгоритмов для архитектуры RISC-V на примере Дискретного Преобразования Фурье (ДПФ)

## Алгоритм работы

1) Создать fork репозитория.
2) Собрать проект для RISC-V архитектуры.
3) Запустить примеры, бенчмарки и тесты на RISC-V Qemu и RISC-V плате.
4) Исправить реализацию DFT4.
    * Включить сборку тестов для DFT4. Запустить их.
5) Добавить реализацию DFT.
    * Включить сборку тестов для реализованных длин DFT. Запустить их, убедиться в корректности реализации.
    * Запустить бенчмарки, сравнить с другими реализациями (если есть).
6) Открыть Pull Request c оптимизациями DFT.
    * В описании должны быть замеры бенчмарков с RVV платы.
    * CI Должен быть зеленым.

## Структура репозитория

* [lib](lib) - библиотека с реализациями DFT
* [examples](examples) - примеры использования библиотеки
* [perf](perf) - бенчмарки для замеров времени выполнения алгоритмов
* [test](test) - функциональные тесты для проверки корректности алгоритмов

## Сборка проекта

Для сборки проекта можно использовать скрипт [build.sh](build.sh). Перед запуском необходимо установить пути для кросс-компиляторов `C_COMPILER_PATH` и `CXX_COMPILER_PATH` и выставить соответствующие параметры сборки.

Опции конфигурации проекта:
* `ENABLE_TEST` - Сборка тестов (`ON`\\`OFF`)
* `ENABLE_BENCH` -  Сборка бенчмарков (`ON`\\`OFF`)
* `ENABLE_EXAMPLES` - Сборка примеров (`ON`\\`OFF`)
* `TARGET_ARCH` - Целевая архитектура
    * `RISCV_GENERIC` - Скалярная версия библиотеки (без RVV)
    * `RISCV_VECTOR` - Векторная версия библиотеки (RVV 0.7.1)
* `BUILD_TYPE` - Режим сборки (`Release`\\`Debug`)
* `BUILD_FOLDER` - Папка для артефактов сборки
* `BUILD_STATIC` - Включить статическую линковку (`ON`\\`OFF`)

## Пример запуска с помощью QEMU

``
qemu-riscv64 -cpu c910v ./_build/examples/dft4_example
``

В случае ошибки:\
``
qemu-riscv64: Could not open '/lib/ld-linux-riscv64-lp64d.so.1': No such file or directory
``\
необходимо сконфигурировать проект с `-DBUILD_STATIC=ON` или добавить ключ запуска `-L <path-to-toolchain>/sysroot/`

## Использование GDB и RISC-V Qemu

1) Запустить QEMU \
``
qemu-riscv64 -g 1234 -cpu c910v ./_build/examples/dft4_example
``
2) Запустить cross GDB\
``
riscv64-unknown-linux-gnu-gdb ./_build/examples/dft4_example
``
3) В консоли GDB подключиться к QEMU \
``
target remote :1234
``
